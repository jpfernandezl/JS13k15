l=function(Q){console.log(Q)};M=Math;c=W.getContext("2d");e=0;f=[];for(i=0;300>i;i++)f[i]=[1200*M.random(),650*M.random(),M.random()+.5];o=n=m=h=g=0;q=2E3;t=[];u=[];v=[];w=[];z=[];A=[];B=[];C=[];D=[];E=[];F=[];G=[];T=S=R=K=J=I=0;
with(new XMLHttpRequest)open("GET","data.bin"),responseType="arraybuffer",send(),onload=function(){a="";for(i in b=new Uint8Array(response))a+=String.fromCharCode(b[i]);a=a.split("\u00fe");for(i=0;i<a.length-1;i+=2)X=[a[i],a[i+1]],Y=[a[i].split(",")[0],a[i+1].split("\u00ff")],Z=[a[i].split(",")[0],a[i].split(",")[1],a[i+1].split("\u00ff")],t.push(Y),z.push(Z),152>i?(u.push(Y),A.push(Z)):246>i?(v.push(Y),B.push(Z)):394>i&&(w.push(Y),C.push(Z));u.sort(X=function(){return.5-M.random()});v.sort(X);w.sort(X);
A.sort(X);B.sort(X);C.sort(X);s=setInterval(function(){W.width^=0;0==e&&d(1,0);1==e&&(H(0),r=3E4);2==e&&(0==m&&d(0,1,0,0,n),1==m&&d(0,1,1,0,n),2==m&&d(0,1,2,0,n),3==m&&m++,4==m&&d(0,1,0,1,n),5==m&&d(0,1,1,1,n),6==m&&d(0,1,2,1,n),7==m&&m++,8==m&&d(0,1,0,2,n),9==m&&d(0,1,1,2,n),10==m&&d(0,1,2,2,n),11==m&&d(0,1,0,0,n),12==m&&d(0,1,0,0,n))},33)};
d=function(Q,L,U,V,aa){W.style.background="#75D1FF";W.style.background=L?"radial-gradient(#75D1FF 50%, #3591bF)":"#000";L||(S--,S%=1200,T+=1,T%=220,N=0);Q&&(c.fillStyle="#fff",c.font="300px Impact, Charcoal",c.fillText("GE",30,375,300),c.fillText("Quiz",620,375,500),c.font="30px Impact, Charcoal",c.fillText("JS13kGames 2015",900,405),c.font="80px Impact, Charcoal",c.fillText("START",500,570));if(!L)for(i=0;300>i;i++)c.beginPath(),c.arc(f[i][0]+S,f[i][1],f[i][2]+.5*M.random(),0,7),c.arc(f[i][0]+S+
1200,f[i][1],f[i][2]+.5*M.random(),0,7),c.fill();L&&(c.rect(0,0,1200,66),c.fill(),c.beginPath(),c.fillStyle="#fff",c.rect(0,60,4*h,5),c.fill(),c.font="40px Impact, Charcoal",c.fillText(["Country: ","Capitol: ","Place: "][U]+[[u,v,w],[A,B,C],[E,F,G]][U][V][aa][[0,1,0][U]],10,45));L||(c.beginPath(),gradient=c.createLinearGradient(300,0,600,0),gradient.addColorStop(0,"#75D1FF"),gradient.addColorStop(1,"#3591bF"),c.fillStyle=gradient,c.arc(470,260,140,0,7),c.fill());c.strokeStyle="#83864F";c.fillStyle=
"#95D866";for(i=0;i<t.length;i++)for(P=t[i][1],j=0;j<P.length;j++){O=P[j];c.beginPath();if(L)for(k=0;k<O.length;k+=2)x=O.charCodeAt(k),y=O.charCodeAt(k+1),c.lineTo(4.6*x+40,2.3*y+70);else for(k=0;k<O.length;k+=2){x=(O.charCodeAt(k)+220-T)/110;for(y=-(O.charCodeAt(k+1)-120)/150;1<x;)x-=2;-1<x&&-.5>x&&(x=-.5);.5<x&&1>x&&(x=.5);k||"Russia"==t[i][0]||"Canada"==t[i][0]||(0>x&&(N=-.5),0<x&&(N=.5));"Russia"==t[i][0]&&(N=-.5,70<T&&(N=.5),170<T&&(N=-.5));"Canada"==t[i][0]&&(N=.5,40<T&&(N=-.5),140<T&&(N=.5));
if(-.5>=x||.5<=x)x=N;x=M.sin(x*M.PI)*M.cos(y*M.PI/2);y=M.sin(-y*M.PI/2);x=140*x+470;y=140*y+260;c.lineTo(x,y)}c.closePath();c.fill();c.stroke()}if(L&&(I||J)){P=[[u,v,w],[A,B,C],[E,F,G]][U][V][aa][1];for(j=0;j<P.length;j++){O=P[j];c.fillStyle="yellow";c.beginPath();for(k=0;k<O.length;k+=2)x=O.charCodeAt(k),y=O.charCodeAt(k+1),c.lineTo(4.6*x+40,2.3*y+70),X=M.sqrt(M.pow(4.6*x+40-I,2)+M.pow(2.3*y+70-J,2)),X<q&&(q=X,p=[4.6*x+40,2.3*y+70]);c.isPointInPath(I,J)&&(K=1);c.closePath();c.fill();c.stroke()}c.fillStyle=
"blue";c.beginPath();c.moveTo(I,J);c.lineTo(I-1,J);c.lineTo(I-1,J-40);c.lineTo(I,J-40);c.lineTo(I+20,J-30);c.lineTo(I,J-20);c.stroke();c.fill();K||(c.strokeStyle="red",c.lineWidth="2",c.setLineDash([5,5]),c.beginPath(),c.moveTo(I,J),c.lineTo(p[0],p[1]),c.stroke());o++;15<o&&(c.textAlign="center",c.fillStyle="#000",c.font="100px Impact, Charcoal",K||5>q?c.fillText("PERFECT",600,350):(c.fillText("GREAT NICE HMMM MEH OWW NOOO".split(" ")[~~(q/30)]||"EEEK",600,350),c.font="50px Impact, Charcoal",c.fillText("You're "+
(100>q?100*~~(q/5):1E3*~~(q/50))+"km away",600,400)))}L&&0==h&&(c.textAlign="center",o++,c.fillStyle="#000",c.font="100px Impact, Charcoal",c.fillText("TIME OUT",600,350),c.font="50px Impact, Charcoal",c.fillText("10,000km penalty",600,400));L&&!o&&h--;58<o&&(c.beginPath,c.fillStyle="#000",c.fillRect(0,0,1200,650));60==o&&(n++,K=o=J=I=0,h=300,q=2E3,10==n&&(n=0,m++,e=1))};
H=function(){W.style.background="#000";c.fillStyle="#fff";c.font="60px Impact, Charcoal";c.textAlign="center";c.fillText("Level "+(m+1)+":",600,280,800);c.fillText("World Countries (easy);Capitols (easy);Famous places (easy);World Countries (medium);Capitols (medium);Famous places (medium);World countries (hard);Famous places (hard);Capitols (hard)".split(";")[m],600,360,800)};W.onclick=function(Q){0==e?e=1:1==e?(e=2,h=300):2!=e||o||(I=Q.pageX,J=Q.pageY)};